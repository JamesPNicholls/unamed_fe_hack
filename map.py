from json import load
from enum import Enum

x_size = 15
y_size = 21

class terrain_type(Enum):
    dash    = 0
    plains  = 1
    forest  = 2
    house   = 3
    village = 4
    cliff   = 5
    sea     = 6
    ruins   = 7
    mnt     = 8
    peak    = 9
    gate    = 0xa

class Cmap:
    # Only used during construction of the map its Csquare children
    map_grid = [
        [0x01, 0x01, 0x01, 0x01, 0x08, 0x08, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09],
        [0x01, 0x01, 0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x08, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09],
        [0x01, 0x02, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x01, 0x02, 0x09, 0x09, 0x09, 0x09, 0x09],
        [0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01, 0x08, 0x08, 0x01, 0x09, 0x09, 0x09, 0x09],
        [0x01, 0x01, 0x01, 0x01, 0x00, 0x0a, 0x00, 0x01, 0x01, 0x02, 0x08, 0x08, 0x09, 0x09, 0x09],
        [0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02, 0x01, 0x01, 0x08, 0x09],
        [0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x09],
        [0x05, 0x05, 0x01, 0x07, 0x07, 0x07, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x08, 0x09],
        [0x06, 0x05, 0x01, 0x07, 0x07, 0x07, 0x01, 0x01, 0x05, 0x02, 0x02, 0x01, 0x01, 0x02, 0x09],
        [0x05, 0x02, 0x01, 0x07, 0x07, 0x07, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 0x01],
        [0x02, 0x05, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02, 0x01, 0x01, 0x01, 0x01, 0x02, 0x01],
        [0x05, 0x02, 0x01, 0x01, 0x05, 0x05, 0x05, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01],
        [0x06, 0x05, 0x05, 0x05, 0x06, 0x06, 0x06, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01],
        [0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01],
        [0x06, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01],
        [0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02, 0x01, 0x03, 0x01, 0x01],
        [0x01, 0x01, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x02, 0x03, 0x01, 0x01, 0x01, 0x01, 0x02],
        [0x01, 0x01, 0x01, 0x01, 0x05, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x02],
        [0x01, 0x01, 0x01, 0x01, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x01],
        [0x01, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x03, 0x01, 0x00, 0x04, 0x00, 0x01],
        [0x02, 0x01, 0x02, 0x02, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01]]


    def __init__(self) -> None:
        # Open json containing grid data, and temp store it in data
        # 'with' automatically closes when out of scope
        with open('data/base_stats.json', 'r') as f:
            data = load(f) 

        for y in range(0,y_size):
            for x in range(0,x_size):
                # generate the tile object and fill it the properties, edit .json to change tile stats
                self.map_grid[y][x] = Csquare(
                    data['tile_stats'][self.map_grid[y][x]]['name'],     
                    data['tile_stats'][self.map_grid[y][x]]['stat_bonus_def'],
                    data['tile_stats'][self.map_grid[y][x]]['stat_bonus_avd'],
                    data['tile_stats'][self.map_grid[y][x]]['heal_amount'],
                    data['tile_stats'][self.map_grid[y][x]]['traverse_lvl'])    
        

    def print_map(self):
        for x in self.map_grid:
            for y in x:
                y.print_data()
            print('new row')
        

class Csquare(Cmap):
    def __init__(self, name, bonus_def, bonus_avd, heal_amt, traverse_amt) -> None:
        self.name           = name 
        self.bonus_def      = bonus_def     
        self.bonus_avd      = bonus_avd     
        self.heal_amount    = heal_amt         
        self.traverse_amt   = traverse_amt         
        self.occupied       = 0
        return

    def print_data(self):
        print(self.name, '\t'
        ,self.bonus_def
        ,self.bonus_avd
        ,self.heal_amount
        ,self.traverse_amt
        ,self.occupied)

# Test functions  
# map = Cmap()
# map.print_map()